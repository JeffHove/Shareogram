var L=o=>{throw TypeError(o)};var W=(o,e,s)=>e.has(o)||L("Cannot "+s);var t=(o,e,s)=>(W(o,e,"read from private field"),s?s.call(o):e.get(o)),p=(o,e,s)=>e.has(o)?L("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(o):e.set(o,s),S=(o,e,s,r)=>(W(o,e,"write to private field"),r?r.call(o,s):e.set(o,s),s);import{a6 as G,B as j,h as b,a7 as D,a8 as K,x as k,w as d,a9 as q,aa as P,u as Y,ab as z,a4 as h}from"./Dd6hhvDe.js";import{b as F}from"./DnDka9iv.js";import{p as N}from"./DIWL0Lin.js";function se(o){if(b){var e=!1,s=()=>{if(!e){if(e=!0,o.hasAttribute("value")){var r=o.value;J(o,"value",null),o.value=r}if(o.hasAttribute("checked")){var l=o.checked;J(o,"checked",null),o.checked=l}}};o.__on_r=s,K(s),F()}}function J(o,e,s,r){var l=o.__attributes??(o.__attributes={});b&&(l[e]=o.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&o.nodeName==="LINK")||l[e]!==(l[e]=s)&&(e==="style"&&"__styles"in o&&(o.__styles={}),e==="loading"&&(o[G]=s),s==null?o.removeAttribute(e):typeof s!="string"&&Q(o).includes(e)?o[e]=s:o.setAttribute(e,s))}var M=new Map;function Q(o){var e=M.get(o.nodeName);if(e)return e;M.set(o.nodeName,e=[]);for(var s,r=o,l=Element.prototype;l!==r;){s=D(r);for(var I in s)s[I].set&&e.push(I);r=j(r)}return e}var T,R,u,m,v;class U{constructor(e,s){p(this,T,e=>{e.storageArea===localStorage&&e.key===t(this,v)&&k(t(this,u),d(t(this,u))+1)});p(this,R);p(this,u,q(0));p(this,m,0);p(this,v);S(this,v,e),S(this,R,s),typeof localStorage<"u"&&localStorage.getItem(e)===null&&localStorage.setItem(e,JSON.stringify(s))}get current(){d(t(this,u));const e=typeof localStorage<"u"?JSON.parse(localStorage.getItem(t(this,v))):t(this,R),s=new WeakMap,r=l=>{if(typeof l!="object"||l===null)return l;let I=s.get(l);return I||(I=new Proxy(l,{set:(_,X,E)=>(k(t(this,u),d(t(this,u))+1),Reflect.set(_,X,E),typeof localStorage<"u"&&localStorage.setItem(t(this,v),JSON.stringify(e)),!0),get:(_,X)=>(d(t(this,u)),r(Reflect.get(_,X)))}),s.set(l,I)),I};return P()&&Y(()=>(t(this,m)===0&&window.addEventListener("storage",t(this,T)),S(this,m,t(this,m)+1),()=>{z().then(()=>{S(this,m,t(this,m)-1),t(this,m)===0&&window.removeEventListener("storage",t(this,T))})})),r(e)}set current(e){typeof localStorage<"u"&&localStorage.setItem(t(this,v),JSON.stringify(e)),k(t(this,u),d(t(this,u))+1)}}T=new WeakMap,R=new WeakMap,u=new WeakMap,m=new WeakMap,v=new WeakMap;const a=o=>{let e=q(N(o));return{set v(r){k(e,N(r))},get v(){return d(e)},reset:()=>k(e,N(o))}},B=o=>{const e=a(o),s=h(()=>e.v.length),r=h(()=>e.v[0].length),l=h(()=>e.v.map(n=>n.map(i=>i.colorIndex))),I=h(()=>{const n=[[]],i=e.v.length,H=e.v[0].length;for(let c=0;c<i;c++){n[c]=[];const w=e.v[c][0],f={colorIndex:w.Xed?-1:w.colorIndex,count:1};for(let g=1;g<H;g++){const y=e.v[c][g-1],x=e.v[c][g];y.colorIndex===x.colorIndex&&y.Xed===x.Xed?f.count++:(n[c].push({...f}),f.colorIndex=x.Xed?-1:x.colorIndex,f.count=1)}n[c].push({...f})}return n}),_=h(()=>d(I).map(n=>n.filter(i=>i.colorIndex!==0&&i.colorIndex!==-1))),X=h(()=>{const n=[[]],i=e.v.length,H=e.v[0].length;for(let c=0;c<H;c++){n[c]=[];const w=e.v[0][c],f={colorIndex:w.Xed?-1:w.colorIndex,count:1};for(let g=1;g<i;g++){const y=e.v[g-1][c],x=e.v[g][c];y.colorIndex===x.colorIndex&&y.Xed===x.Xed?f.count++:(n[c].push({...f}),f.colorIndex=x.Xed?-1:x.colorIndex,f.count=1)}n[c].push({...f})}return n}),E=h(()=>d(X).map(n=>n.filter(i=>i.colorIndex!==0&&i.colorIndex!==-1)));return{get columnEncodes(){return d(X)},get colorIndices(){return d(l)},get columnHints(){return d(E)},get rowEncodes(){return d(I)},get numColumns(){return d(r)},get rowHints(){return d(_)},set v(n){e.v=n},get numRows(){return d(s)},get v(){return e.v},reset:e.reset}},te=new U("preferences",{bgColor:"#476fb8"}),re=a(["#ffffff","#000000"]),ne=a(1),O=[[{colorIndex:0,Xed:!1},{colorIndex:0,Xed:!1},{colorIndex:0,Xed:!1},{colorIndex:0,Xed:!1},{colorIndex:0,Xed:!1}],[{colorIndex:0,Xed:!1},{colorIndex:0,Xed:!1},{colorIndex:0,Xed:!1},{colorIndex:0,Xed:!1},{colorIndex:0,Xed:!1}],[{colorIndex:0,Xed:!1},{colorIndex:0,Xed:!1},{colorIndex:0,Xed:!1},{colorIndex:0,Xed:!1},{colorIndex:0,Xed:!1}],[{colorIndex:0,Xed:!1},{colorIndex:0,Xed:!1},{colorIndex:0,Xed:!1},{colorIndex:0,Xed:!1},{colorIndex:0,Xed:!1}],[{colorIndex:0,Xed:!1},{colorIndex:0,Xed:!1},{colorIndex:0,Xed:!1},{colorIndex:0,Xed:!1},{colorIndex:0,Xed:!1}]],ce=a(5),le=a(5),A=B(O),C=B(O),de=a([O]),ae=a(0),ie=a(!1),fe=a({colorIndex:-1,column:-1,Xed:!1,row:-1}),ue=a(1),Ie=a(!1),ge=a(!1),xe=a(!1),he=a(!1),ve=a(!1),V=h(()=>{let o=!0;for(let e=0;e<A.numRows;e++)for(let s=0;s<A.numColumns;s++)C.v[e]&&C.v[e][s]&&C.v[e][s].colorIndex!==A.v[e][s].colorIndex&&(o=!1);return o}),me=()=>d(V);export{le as a,A as b,re as c,ge as d,ce as e,ne as f,de as g,ae as h,ie as i,he as j,ve as k,ue as l,Ie as m,me as n,xe as o,te as p,fe as q,se as r,J as s,C as t};
